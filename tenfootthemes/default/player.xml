<?xml version="1.0" encoding="UTF-8" ?>
<torctheme>
    <window name="background" inherits="/basewindow">
        <shape name="background" position="0,0,1920,1080">
            <animation name="Shown">
                <element duration="500" property="alpha" endvalue="1" easingcurve="outquad"/>
                <element duration="500" property="zoom" endvalue="1" easingcurve="outquad"/>
            </animation>
            <animation name="Deactivated">
                <connect signal="Finished" slot="Hide" receiver=".."/>
                <element duration="500" property="alpha" endvalue="0" easingcurve="outquad"/>
                <element duration="500" property="zoom" endvalue="0.8" easingcurve="outquad"/>
            </animation>
            <path>
                <pen color="AAAAAAFF" width="10"/>
                <addroundedrect rect="15,15,1890,1050" xradius="30" yradius="30"/>
            </path>
        </shape>
        <widget name="opening" position="1720,900,100,100">
            <state visible="false"/>
            <connect signal="Shown"  slot="Start" receiver="clockwise_rotate"/>
            <connect signal="Hidden" slot="Stop"  receiver="clockwise_rotate"/>
            <shape name="clockwise" position="0,0,100,100">
                <effect centre="middle"/>
                <animation name="rotate">
                    <group type="sequential" loopcount="-1">
                        <element duration="1000" property="rotation" endvalue="360"/>
                        <element duration="0" property="rotation" endvalue="0"/>
                    </group>
                </animation>
                <path>
                    <pen color="AAAAAAFF" width="8" penstyle="DashLine" pencapstyle="RoundCap"/>
                    <moveto point="0,50"/>
                    <arcto rect="5,5,90,90" startangle="180" sweeplength="180"/>
                </path>
            </shape>
        </widget>
        <media name="player" position="0,0,1920,1080">
            <effect alpha="0"/>
            <animation name="Selected">
                <element duration="1000" property="alpha" endvalue="1" easingcurve="outquad"/>
            </animation>
            <animation name="Deactivated">
                <connect signal="Finished" slot="Hide" receiver=".."/>
                <element duration="1000" property="alpha" endvalue="0" easingcurve="outquad"/>
            </animation>
            <scriptfunction name="Finalise">
                SetState(this.GetState());
                SetProperty(TorcPlayer.Brightness, this.GetProperty(TorcPlayer.Brightness));
                SetProperty(TorcPlayer.Contrast,   this.GetProperty(TorcPlayer.Contrast));
                SetProperty(TorcPlayer.Saturation, this.GetProperty(TorcPlayer.Saturation));
                SetProperty(TorcPlayer.Hue,        this.GetProperty(TorcPlayer.Hue));
                background_player_reveal_colourcontrols.Hide();
            </scriptfunction>
            <scriptfunction name="SetState" arguments="Value">
            <![CDATA[
                if (Value == TorcPlayer.Errored || Value == TorcPlayer.None ||
                    Value == TorcPlayer.Stopped || Value == TorcPlayer.Opening)
                {
                    background_player.Deactivate();
                    if (background_background.IsVisible())
                    {
                        background_background_Deactivated.Stop();
                        background_background_Shown.Start();
                    }
                    background_background.Activate();
                    background_topmenu.Activate();
                }
                else
                {
                    background_background.Deactivate();
                    background_topmenu.Hide();
                    background_player.Select();
                }

                if (Value == TorcPlayer.Opening)
                {
                    background_opening.Show();
                }
                else
                {
                    background_opening.Hide();
                }
            ]]>
            </scriptfunction>
            <scriptfunction name="SetProperty" arguments="Property,Value">
                var actioned = false;
                if (Property == TorcPlayer.Brightness)
                {
                    background_player_reveal_colourcontrols_brightness.SetText(Value);
                    background_player_reveal_colourcontrols_brightness_switch.SetRotation((Value - 50) * 1.8);
                    actioned = true;
                }
                else if (Property == TorcPlayer.Contrast)
                {
                    background_player_reveal_colourcontrols_contrast.SetText(Value);
                    background_player_reveal_colourcontrols_contrast_switch.SetRotation((Value - 50) * 1.8);
                    actioned = true;
                }
                else if (Property == TorcPlayer.Saturation)
                {
                    background_player_reveal_colourcontrols_saturation.SetText(Value);
                    background_player_reveal_colourcontrols_saturation_switch.SetRotation((Value - 50) * 1.8);
                    actioned = true;
                }
                else if (Property == TorcPlayer.Hue)
                {
                    background_player_reveal_colourcontrols_hue.SetText(Value);
                    background_player_reveal_colourcontrols_hue_switch.SetRotation((Value - 50) * 1.8);
                    actioned = true;
                }
                if (actioned)
                {
                    background_player_reveal_colourcontrols_Deactivated.Stop();
                    background_player_reveal_colourcontrols.Activate();
                }
            </scriptfunction>
            <scriptfunction name="PropertyAvailable" arguments="Property">
                if (Property == TorcPlayer.Brightness)
                    background_player_reveal_colourcontrols_brightness.Show();
                else if (Property == TorcPlayer.Contrast)
                    background_player_reveal_colourcontrols_contrast.Show();
                else if (Property == TorcPlayer.Saturation)
                    background_player_reveal_colourcontrols_saturation.Show();
                else if (Property == TorcPlayer.Hue)
                    background_player_reveal_colourcontrols_hue.Show();
            </scriptfunction>
            <scriptfunction name="PropertyUnavailable" arguments="Property">
                if (Property == TorcPlayer.Brightness)
                    background_player_reveal_colourcontrols_brightness.Hide();
                else if (Property == TorcPlayer.Contrast)
                    background_player_reveal_colourcontrols_contrast.Hide();
                else if (Property == TorcPlayer.Saturation)
                    background_player_reveal_colourcontrols_saturation.Hide();
                else if (Property == TorcPlayer.Hue)
                    background_player_reveal_colourcontrols_hue.Hide();
            </scriptfunction>
            <connect signal="Finalised"                     slot="Finalise"/>
            <connect signal="StateChanged(int)"             slot="SetState"/>
            <connect signal="PropertyChanged(int,QVariant)" slot="SetProperty"/>
            <connect signal="PropertyAvailable(int)"        slot="PropertyAvailable"/>
            <connect signal="PropertyUnavailable(int)"      slot="PropertyUnavailable"/>
            <widget name="reveal" position="1020,780,800,200">
                <clip rect="0,0,800,185"/>
                <group name="colourcontrols" position="0,200,800,200">
                    <effect alpha="0" centre="bottom"/>
                    <animation name="Activated">
                        <connect signal="Finished" receiver=".." slot="Deactivate"/>
                        <group type="sequential">
                            <group type="parallel">
                                <element duration="400" property="alpha" endvalue="1" easingcurve="outquad"/>
                                <element duration="400" property="position" endvalue="0,0" easingcurve="outquad"/>
                            </group>
                            <pause duration="5000"/>
                        </group>
                    </animation>
                    <animation name="Deactivated">
                        <connect signal="Finished" receiver=".." slot="Hide"/>
                        <element duration="1000" property="alpha" endvalue="0"/>
                        <element duration="1000" property="position" endvalue="0,200"/>
                    </animation>
                    <layout type="horizontal" alignment="left"/>
                    <text name="knob" position="0,0,200,200" inherits="/templates_button_text" template="1">
                        <shape name="switch" position="0,0,200,200">
                            <path>
                                <pen color="DDDDDDFF" width="3"/>
                                <addellipse rect="30,30,140,140"/>
                                <moveto point="100,30"/>
                                <lineto point="100,15"/>
                            </path>
                            <fixedblur radius="1"/>
                        </shape>
                        <shape name="surround" position="0,0,200,200">
                            <path>
                                <pen color="FF0000FF" width="3"/>
                                <moveto point="15,100"/>
                                <lineto point="26,100"/>
                                <arcto  rect="26,26,148,148" startangle="180" sweeplength="180"/>
                                <lineto point="185,100"/>
                            </path>
                        </shape>
                    </text>
                    <text name="brightness" inherits="../knob" />
                    <text name="contrast"   inherits="../knob" />
                    <text name="saturation" inherits="../knob" />
                    <text name="hue"        inherits="../knob" />
                </group>
            </widget>
        </media>
        <messenger name="messages" position="100,100,600,880">
            <group name="group" position="0,0,600,880">
                <layout type="vertical" alignment="top"/>
            </group>
            <widget name="template" position="0,0,600,100" template="true">
                <shape name="bg" position="0,0,600,100">
                    <path>
                        <pen color="880000FF" width="3" penstyle="SolidLine"/>
                        <brush color="66666699" brushstyle="SolidPattern"/>
                        <addroundedrect rect="2,2,594,94" xradius="11" yradius="11"/>
                    </path>
                </shape>
                <effect alpha="0.0" centre="middle"/>
                <animation name="Activated">
                    <element property="alpha" endvalue="1.0"/>
                </animation>
                <animation name="Deactivated">
                    <element duration="100" property="alpha" endvalue="0.0"/>
                    <element duration="500" property="verticalzoom" endvalue="0.0" easingcurve="outquad"/>
                </animation>
                <text name="header" position="0,0,600,100">
                    <font name="main" alignment="left"/>
                </text>
            </widget>
        </messenger>
        <group name="topmenu" position="0,700,1920,100">
            <layout type="horizontal" selectrange="100,0,1720,100"/>
            <scroll speed="1000" easingcurve="outquad"/>
            <button name="play" inherits="/templates_button">
                <scriptfunction name="play">
                    background_player.Play();
                </scriptfunction>
                <message>Play</message>
                <connect signal="Released" slot="play"/>
            </button>
            <button name="settings" inherits="/templates_button">
                <message>Settings</message>
                <connect signal="Released" slot="SetAsRootWidget" receiver="/settings"/>
            </button>
        </group>
    </window>
</torctheme>
